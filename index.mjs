// Copyright (c) 2023 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import e from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-assert-is-nan@v0.1.0-esm/index.mjs";import t from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float32-smallest-normal@v0.1.0-esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-pinf@v0.1.0-esm/index.mjs";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-tools-evalpoly@v0.1.0-esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-gammaln@esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-erfcinv@esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-gamma@v0.1.0-esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-sqrt@v0.1.0-esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-abs@v0.1.0-esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-exp@v0.1.0-esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-min@v0.1.0-esm/index.mjs";import p from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-pow@v0.1.0-esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-ln@esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-sqrt-two-pi@v0.1.0-esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float32-max@v0.1.0-esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-two-pi@v0.1.0-esm/index.mjs";import v from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-gammainc@esm/index.mjs";import j from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-ln-sqrt-two-pi@v0.1.0-esm/index.mjs";function b(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var n=function e(){if(this instanceof e){var n=[null];n.push.apply(n,arguments);var r=Function.bind.apply(t,n);return new r}return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})})),n}var g=b(Object.freeze({__proto__:null,default:()=>()=>{}})),x=g("gammaincinv:higher_newton");var w=[1,0,0,0,0,0];function y(e){var t,n,s,i,o,a,d,p,f,u;if(f=e*e*.5,0===e?o=0:e<-1?(p=l(-1-f),o=0===(u=p)?0:0+u*(1+u*(1+u*(1.5+u*(2.6666666666666665+u*(5.208333333333333+10.8*u)))))):e<1?o=function(e){return 0===e?1:1+e*(1+e*(.3333333333333333+e*(.027777777777777776+e*(e*(.0002314814814814815+5878894767783657e-20*e)-.003703703703703704))))}(p=e):(o=(p=11+f)+(a=c(p)),p=1/p,i=(s=(n=(t=a*a)*a)*a)*a,w[1]=.5*(2-a),w[2]=(-9*a+6+2*t)/6,w[3]=.08333333333333333*-(3*n+36*a-22*t-12),w[4]=(60+350*t-300*a-125*n+12*s)/60,w[5]=.008333333333333333*-(-120-274*s+900*a-1700*t+1125*n+20*i),o+=a*p*r(w,p)),p=1,e>-3.5&&e<-.03||e>.03&&e<40){p=1,d=o;do{o=d*(f+c(d))/(d-1),p=m(d/o-1),d=o}while(p>1e-8)}return o}var _=[1.9963790515900766,-.0017971032528832887,13129285796384672e-21,-2.340875228178749e-7,7.2291210671127e-9,-3.280997607821e-10,19875070901e-21,-1509214183e-21,1375340084e-22,-145728923e-22,17532367e-22,-2351465e-22,346551e-22,-55471e-22,9548e-22,-1748e-22,3.32e-20,-58e-22];function O(e){var n;return e<t?u:e<1?s(e+1)-(e+.5)*c(e)+e-j:e<2?s(e)-(e-.5)*c(e)+e-j:e<3?s(e-1)-(e-.5)*c(e)+e-j+c(e-1):e<12?function(e,t){var n,r,s,i,o;r=0,s=0,n=t+t,o=e;do{i=s,r=n*(s=r)-i+_[o],o-=1}while(o>=0);return(r-i)/2}(17,n=18/(e*e)-1)/(12*e):(n=1/(e*e),e<1e3?function(e){return 0===e?.025721014990011306:.025721014990011306+e*(.08247596616699963+e*(e*(.0006099292666946337+e*(.000250505279903*e-.00033543297638406))-.0025328157302663564))}(n)/(.30865217988013566+n)/e:function(e){return 0===e?.08333333333333333:.08333333333333333+e*(e*(.0007936507936507937+-.0005952380952380953*e)-.002777777777777778)}(n)/e)}function N(e){return e>=3?l(O(e)):e>0?o(e)/(l(-e+(e-.5)*c(e))*f):u}var q=g("gammaincinv:compute"),P=.3333333333333333,W=.16666666666666666,M=[0,0,0,0,0];function T(e,t,n){var j,b,g,w,_,O,T,k,z,D,E,F,A,B,C,G,H,I,J,K,L,Q,R,S,U,V,X,Y,Z,$,ee,te,ne,re,se,ie,oe,ae,me,le;if(t<.5?(w=!0,_=t,ae=-1):(w=!1,_=n,ae=1),se=0,m(e-1)<1e-4&&(ie=0,J=w?t<.001?t+.5*(Z=t*t)+(V=Z*t)*P+.25*(Y=V*t)+.2*(I=Y*t)+I*t*W:-c(1-t):-c(n),1===e?(se=2,ee=J):(g=s(e),se=1)),n<1e-30&&e<.5&&(ie=0,J=-c(n*o(e))+(e-1)*c(-c(n*o(e))),se=1,g=s(e)),e>1&&e<500&&t<1e-80){for(ie=0,O=1/e,j=1/(e+1),J=(s(e+1)+c(t))*O,A=J=l(J),re=0;re<10;re++)J=A*l(J*O)*p(1-J*j,O);se=1,g=s(e)}if((T=1/e*(c(t)+s(e+1)))<c(.2*(1+e))&&0===se&&(oe=l(T),ie=0,X=($=(K=e*e)*e)*e,D=(B=e+1)*(E=B*B),z=E*E,k=(C=e+2)*C,G=e+3,M[0]=1,M[1]=1/B,M[2]=.5*(3*e+5)/(E*C),M[3]=P*(31+8*K+33*e)/(D*C*G),M[4]=.041666666666666664*(2888+1179*$+125*X+3971*K+5661*e)/(z*k*G*(e+4)),J=oe*r(M,oe),g=s(e),se=1),e<10&&0===se&&(F=a(e)/(N(e)*f),n<d(.02,F)&&(ie=0,U=(S=(te=1-e)*te)*te,J=e*y(H=a(-2/e*c(n/F))),ne=c(J),J>5?(R=(Q=(L=ne*ne)*ne)*ne,oe=1/J,M[0]=ne-1,M[1]=.5*(3*te-2*te*ne+L-2*ne+2),M[2]=(24*te*ne-11*S-24*te-6*L+12*ne-12-9*te*L+6*S*ne+2*Q)*W,M[3]=.08333333333333333*(-12*U*ne+8.04*te*L-114*S*ne+(72+36*L)+(3*R-72*ne+162)*(te-168*te*ne)-(12*Q+25*U)-(22*te*Q+36*S*L+120*S)),M[4]=0,J=J-ne+te*oe*r(M,oe)):(L=ne*ne,(me=ne-te*(oe=1/J)*(ne-1))<J&&(J-=me)),g=s(e),se=1)),m(_-.5)<1e-5&&0===se&&(ie=0,J=e-P+(.019753086419753086+.007211444248481286*(O=1/e))*O,g=s(e),se=1),e<1&&0===se&&(ie=0,J=l(w?1/e*(c(_)+s(e+1)):1/e*(c(1-_)+s(e+1))),g=s(e),se=1),0===se){if(ie=1,O=1/e,H=ae*(oe=i(2*_))/a(.5*e),!(oe<u))return q("Warning: Overflow problems in one or more steps of the computation."),NaN;H+=(function(e){var t,n,r,s;return m(e)<1?0===(n=e)?-.3333333333438:((n<0?-n:n)<=1?(r=n*(n*(n*(-4293658292782e-17*n-.004923635739372)-.05041806657154)-.2070740359969)-.3333333333438,s=1+n*(.7045554412463+n*(.2118190062224+n*(.03048648397436+.001605037988091*n)))):(r=(n=1/n)*(n*(n*(-.3333333333438*n-.2070740359969)-.05041806657154)-.004923635739372)-4293658292782e-17,s=.001605037988091+n*(.03048648397436+n*(.2118190062224+n*(.7045554412463+1*n)))),r/s):(t=y(e),c(e/(t-1))/e)}(H)+(function(e){var t,n;return e<-5?(12-(n=e*e)-(t=c(-e))*t*6)/(12*n*e):e<-2?function(e){var t,n;return 0===e?-.0172847633523:((e<0?-e:e)<=1?(t=e*(e*(e*(-614830384279e-17*e-.00060683488776)-.00464910887221)-.0159372646475)-.0172847633523,n=1+e*(.764050615669+e*(.297143406325+e*(.0579490176079+.00574558524851*e)))):(t=(e=1/e)*(e*(e*(-.0172847633523*e-.0159372646475)-.00464910887221)-.00060683488776)-614830384279e-17,n=.00574558524851+e*(.0579490176079+e*(.297143406325+e*(.764050615669+1*e)))),t/n)}(e):e<2?function(e){var t,n;return 0===e?-.0172839517431:((e<0?-e:e)<=1?(t=e*(e*(e*(249634036069e-17*e-.000391032032692)-.00357406772616)-.0146362417966)-.0172839517431,n=1+e*(.690560400696+e*(.249962384741+e*(.0443843438769+.00424073217211*e)))):(t=249634036069e-17+(e=1/e)*(e*(e*(-.0172839517431*e-.0146362417966)-.00357406772616)-.000391032032692),n=.00424073217211+e*(.0443843438769+e*(.249962384741+e*(.690560400696+1*e)))),t/n)}(e):e<1e3?(n=1/e,function(e){var t,n;return 0===e?.99994466948:((e<0?-e:e)<=1?(t=.99994466948+e*(104.649839762+e*(857.204033806+e*(731.901559577+45.5174411671*e))),n=1+e*(104.526456943+e*(823.313447808+e*(3119.93802124+3970.03311219*e)))):(t=45.5174411671+(e=1/e)*(731.901559577+e*(857.204033806+e*(104.649839762+.99994466948*e))),n=3970.03311219+e*(3119.93802124+e*(823.313447808+e*(104.526456943+1*e)))),t/n)}(e)/(-12*e)):-1/(12*e)}(H)+function(e){var t,n;return e<-8?(t=e*e,(e*(n=c(-e)/e)*(6*t*n*n-12+t)-30)/(12*e*t*t)):e<-4?function(e){var t,n;return 0===e?.0495346498136:((e<0?-e:e)<=1?(t=.0495346498136+e*(.0299521337141+e*(.00688296911516+e*(.000512634846317+-201411722031e-16*e))),n=1+e*(.759803615283+e*(.261547111595+e*(.0464854522477+.00403751193496*e)))):(t=(e=1/e)*(.000512634846317+e*(.00688296911516+e*(.0299521337141+.0495346498136*e)))-201411722031e-16,n=.00403751193496+e*(.0464854522477+e*(.261547111595+e*(.759803615283+1*e)))),t/n)}(e)/(e*e):e<-2?function(e){var t,n;return 0===e?.00452313583942:((e<0?-e:e)<=1?(t=.00452313583942+e*(.00120744920113+e*(e*(-535770949796e-17*e-504476066942e-16)-789724156582e-16)),n=1+e*(.912203410349+e*(.405368773071+e*(.0901638932349+.00948935714996*e)))):(t=(e=1/e)*(e*(e*(.00120744920113+.00452313583942*e)-789724156582e-16)-504476066942e-16)-535770949796e-17,n=.00948935714996+e*(.0901638932349+e*(.405368773071+e*(.912203410349+1*e)))),t/n)}(e):e<2?function(e){var t,n;return 0===e?.00439937562904:((e<0?-e:e)<=1?(t=.00439937562904+e*(.000487225670639+e*(e*(529110969589e-17+1.5716677175e-7*e)-.000128470657374)),n=1+e*(.794435257415+e*(.333094721709+e*(.0703527806143+.00806110846078*e)))):(t=1.5716677175e-7+(e=1/e)*(529110969589e-17+e*(e*(.000487225670639+.00439937562904*e)-.000128470657374)),n=.00806110846078+e*(.0703527806143+e*(.333094721709+e*(.794435257415+1*e)))),t/n)}(e):e<10?function(e){var t,n;return 0===e?-.0011481191232:((e<0?-e:e)<=1?(t=e*(e*(1.51623048511+e*(.0730002451555*e-.218472031183))-.112850923276)-.0011481191232,n=1+e*(14.2482206905+e*(69.7360396285+e*(218.938950816+277.067027185*e)))):(t=.0730002451555+(e=1/e)*(e*(1.51623048511+e*(-.0011481191232*e-.112850923276))-.218472031183),n=277.067027185+e*(218.938950816+e*(69.7360396285+e*(14.2482206905+1*e)))),t/n)}(t=1/e)/(e*e):e<100?function(e){var t,n;return 0===e?-.000145727889667:((e<0?-e:e)<=1?(t=e*(e*(e*(199.722374056+-11.4311378756*e)-13.308504545)-.290806748131)-.000145727889667,n=1+e*(139.612587808+e*(2189.01116348+e*(7115.24019009+45574.6081453*e)))):(t=(e=1/e)*(199.722374056+e*(e*(-.000145727889667*e-.290806748131)-13.308504545))-11.4311378756,n=45574.6081453+e*(7115.24019009+e*(2189.01116348+e*(139.612587808+1*e)))),t/n)}(t=1/e)/(e*e):-c(e)/(12*e*e*e)}(H)*O)*O)*O,J=e*y(H),le=H,b=1/(-a(e/h)*l(-.5*e*le*le)/N(e))}return se<2&&(ee=function(e,t,n,r,s,i,o,a){var d,p,f,h,j,b,g,w,y;y=e,b=1,g=1,h=t*t,p=e;do{if(j=(y=e)*y,0===n){if((d=(1-t)*c(y)+y+i)>c(u))return x("Warning: overflow problems in one or more steps of the computation. The initial approximation to the root is returned."),p;w=l(d)}else w=-o*y;w=a?-w*(v(y,t,!0,!1)-r):w*(v(y,t,!0,!0)-s),r>1e-120||g>1?(f=(2*j-4*y*t+4*y+2*h-3*t+1)/j,e=y+w*(1+w*(.5*(y-t+1)/y+w*(f/=6)))):e=y+w,b=m(y/e-1),g+=1,(y=e)<0&&(y=p,g=100)}while(b>2e-14&&g<35);return(b>2e-14||g>99)&&x("Warning: the number of iterations in the Newton method reached the upper limit N=35. The last value obtained for the root is given as output."),y||0}(J,e,ie,t,n,g,b,w)),ee}function k(r,s,i){return e(r)||e(s)||s<t||r>1||r<0?NaN:!0===i?0===r?n:1===r?0:T(s,1-r,r):0===r?0:1===r?n:T(s,r,1-r)}export{k as default};
//# sourceMappingURL=index.mjs.map
