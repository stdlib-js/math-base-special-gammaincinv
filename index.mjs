// Copyright (c) 2022 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import e from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-assert-is-nan@esm/index.mjs";import t from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float32-smallest-normal@esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-pinf@esm/index.mjs";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-tools-evalpoly@esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-gammaln@esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-erfcinv@esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-gamma@esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-sqrt@esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-abs@esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-exp@esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-min@esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-pow@esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-ln@esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-sqrt-two-pi@esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float32-max@esm/index.mjs";import p from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-two-pi@esm/index.mjs";import v from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-gammainc@esm/index.mjs";import j from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-ln-sqrt-two-pi@esm/index.mjs";function b(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})})),t}var g="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function w(){throw new Error("setTimeout has not been defined")}function x(){throw new Error("clearTimeout has not been defined")}var y=w,T=x;function N(e){if(y===setTimeout)return setTimeout(e,0);if((y===w||!y)&&setTimeout)return y=setTimeout,setTimeout(e,0);try{return y(e,0)}catch(t){try{return y.call(null,e,0)}catch(t){return y.call(this,e,0)}}}"function"==typeof g.setTimeout&&(y=setTimeout),"function"==typeof g.clearTimeout&&(T=clearTimeout);var _,O=[],q=!1,E=-1;function k(){q&&_&&(q=!1,_.length?O=_.concat(O):E=-1,O.length&&D())}function D(){if(!q){var e=N(k);q=!0;for(var t=O.length;t;){for(_=O,O=[];++E<t;)_&&_[E].run();E=-1,t=O.length}_=null,q=!1,function(e){if(T===clearTimeout)return clearTimeout(e);if((T===x||!T)&&clearTimeout)return T=clearTimeout,clearTimeout(e);try{T(e)}catch(t){try{return T.call(null,e)}catch(t){return T.call(this,e)}}}(e)}}function M(e,t){this.fun=e,this.array=t}M.prototype.run=function(){this.fun.apply(null,this.array)};function L(){}var P=L,W=L,z=L,A=L,B=L,C=L,F=L;var G=g.performance||{},H=G.now||G.mozNow||G.msNow||G.oNow||G.webkitNow||function(){return(new Date).getTime()};var I=new Date;var J={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];O.push(new M(e,t)),1!==O.length||q||N(D)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:P,addListener:W,once:z,off:A,removeListener:B,removeAllListeners:C,emit:F,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*H.call(G),n=Math.floor(t),r=Math.floor(t%1*1e9);return e&&(n-=e[0],(r-=e[1])<0&&(n--,r+=1e9)),[n,r]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-I)/1e3}};module.exports=void 0!==J&&"renderer"===J.type?require("./browser.js"):require("./node.js");var K=b(Object.freeze({__proto__:null})),Q=v,R=m,S=u,U=f,V=h,X=K("gammaincinv:higher_newton");var Y=m,Z=u,$=f,ee=r,te=function(e){return 0===e?0:0+e*(1+e*(1+e*(1.5+e*(2.6666666666666665+e*(5.208333333333333+10.8*e)))))},ne=function(e){return 0===e?1:1+e*(1+e*(.3333333333333333+e*(.027777777777777776+e*(e*(.0002314814814814815+5878894767783657e-20*e)-.003703703703703704))))},re=[1,0,0,0,0,0];var ie=function(e){var t,n,r,i,o,s,a,m,u;if(u=e*e*.5,0===e?o=0:e<-1?(m=Z(-1-u),o=te(m)):e<1?o=ne(m=e):(o=(m=11+u)+(s=$(m)),m=1/m,i=(r=(n=(t=s*s)*s)*s)*s,re[1]=.5*(2-s),re[2]=(-9*s+6+2*t)/6,re[3]=.08333333333333333*-(3*n+36*s-22*t-12),re[4]=(60+350*t-300*s-125*n+12*r)/60,re[5]=.008333333333333333*-(-120-274*r+900*s-1700*t+1125*n+20*i),o+=s*m*ee(re,m)),m=1,e>-3.5&&e<-.03||e>.03&&e<40){m=1,a=o;do{o=a*(u+$(a))/(a-1),m=Y(a/o-1),a=o}while(m>1e-8)}return o},oe=[1.9963790515900766,-.0017971032528832887,13129285796384672e-21,-2.340875228178749e-7,7.2291210671127e-9,-3.280997607821e-10,19875070901e-21,-1509214183e-21,1375340084e-22,-145728923e-22,17532367e-22,-2351465e-22,346551e-22,-55471e-22,9548e-22,-1748e-22,3.32e-20,-58e-22];var se=i,ae=f,me=j,ue=t,le=h,ce=function(e,t){var n,r,i,o,s;r=0,i=0,n=t+t,s=e;do{o=i,r=n*(i=r)-o+oe[s],s-=1}while(s>=0);return(r-o)/2},fe=function(e){return 0===e?.025721014990011306:.025721014990011306+e*(.08247596616699963+e*(e*(.0006099292666946337+e*(.000250505279903*e-.00033543297638406))-.0025328157302663564))},de=function(e){return 0===e?.08333333333333333:.08333333333333333+e*(e*(.0007936507936507937+-.0005952380952380953*e)-.002777777777777778)};var he=u,pe=s,ve=f,je=h,be=d,ge=function(e){var t;return e<ue?le:e<1?se(e+1)-(e+.5)*ae(e)+e-me:e<2?se(e)-(e-.5)*ae(e)+e-me:e<3?se(e-1)-(e-.5)*ae(e)+e-me+ae(e-1):e<12?ce(17,t=18/(e*e)-1)/(12*e):(t=1/(e*e),e<1e3?fe(t)/(.30865217988013566+t)/e:de(t)/e)};var we=m,xe=f,ye=ie,Te=function(e){var t,n;return 0===e?-.3333333333438:((e<0?-e:e)<=1?(t=e*(e*(e*(-4293658292782e-17*e-.004923635739372)-.05041806657154)-.2070740359969)-.3333333333438,n=1+e*(.7045554412463+e*(.2118190062224+e*(.03048648397436+.001605037988091*e)))):(t=(e=1/e)*(e*(e*(-.3333333333438*e-.2070740359969)-.05041806657154)-.004923635739372)-4293658292782e-17,n=.001605037988091+e*(.03048648397436+e*(.2118190062224+e*(.7045554412463+1*e)))),t/n)};var Ne=f,_e=function(e){var t,n;return 0===e?-.0172847633523:((e<0?-e:e)<=1?(t=e*(e*(e*(-614830384279e-17*e-.00060683488776)-.00464910887221)-.0159372646475)-.0172847633523,n=1+e*(.764050615669+e*(.297143406325+e*(.0579490176079+.00574558524851*e)))):(t=(e=1/e)*(e*(e*(-.0172847633523*e-.0159372646475)-.00464910887221)-.00060683488776)-614830384279e-17,n=.00574558524851+e*(.0579490176079+e*(.297143406325+e*(.764050615669+1*e)))),t/n)},Oe=function(e){var t,n;return 0===e?-.0172839517431:((e<0?-e:e)<=1?(t=e*(e*(e*(249634036069e-17*e-.000391032032692)-.00357406772616)-.0146362417966)-.0172839517431,n=1+e*(.690560400696+e*(.249962384741+e*(.0443843438769+.00424073217211*e)))):(t=249634036069e-17+(e=1/e)*(e*(e*(-.0172839517431*e-.0146362417966)-.00357406772616)-.000391032032692),n=.00424073217211+e*(.0443843438769+e*(.249962384741+e*(.690560400696+1*e)))),t/n)},qe=function(e){var t,n;return 0===e?.99994466948:((e<0?-e:e)<=1?(t=.99994466948+e*(104.649839762+e*(857.204033806+e*(731.901559577+45.5174411671*e))),n=1+e*(104.526456943+e*(823.313447808+e*(3119.93802124+3970.03311219*e)))):(t=45.5174411671+(e=1/e)*(731.901559577+e*(857.204033806+e*(104.649839762+.99994466948*e))),n=3970.03311219+e*(3119.93802124+e*(823.313447808+e*(104.526456943+1*e)))),t/n)};var Ee=f,ke=function(e){var t,n;return 0===e?.0495346498136:((e<0?-e:e)<=1?(t=.0495346498136+e*(.0299521337141+e*(.00688296911516+e*(.000512634846317+-201411722031e-16*e))),n=1+e*(.759803615283+e*(.261547111595+e*(.0464854522477+.00403751193496*e)))):(t=(e=1/e)*(.000512634846317+e*(.00688296911516+e*(.0299521337141+.0495346498136*e)))-201411722031e-16,n=.00403751193496+e*(.0464854522477+e*(.261547111595+e*(.759803615283+1*e)))),t/n)},De=function(e){var t,n;return 0===e?.00452313583942:((e<0?-e:e)<=1?(t=.00452313583942+e*(.00120744920113+e*(e*(-535770949796e-17*e-504476066942e-16)-789724156582e-16)),n=1+e*(.912203410349+e*(.405368773071+e*(.0901638932349+.00948935714996*e)))):(t=(e=1/e)*(e*(e*(.00120744920113+.00452313583942*e)-789724156582e-16)-504476066942e-16)-535770949796e-17,n=.00948935714996+e*(.0901638932349+e*(.405368773071+e*(.912203410349+1*e)))),t/n)},Me=function(e){var t,n;return 0===e?.00439937562904:((e<0?-e:e)<=1?(t=.00439937562904+e*(.000487225670639+e*(e*(529110969589e-17+1.5716677175e-7*e)-.000128470657374)),n=1+e*(.794435257415+e*(.333094721709+e*(.0703527806143+.00806110846078*e)))):(t=1.5716677175e-7+(e=1/e)*(529110969589e-17+e*(e*(.000487225670639+.00439937562904*e)-.000128470657374)),n=.00806110846078+e*(.0703527806143+e*(.333094721709+e*(.794435257415+1*e)))),t/n)},Le=function(e){var t,n;return 0===e?-.0011481191232:((e<0?-e:e)<=1?(t=e*(e*(1.51623048511+e*(.0730002451555*e-.218472031183))-.112850923276)-.0011481191232,n=1+e*(14.2482206905+e*(69.7360396285+e*(218.938950816+277.067027185*e)))):(t=.0730002451555+(e=1/e)*(e*(1.51623048511+e*(-.0011481191232*e-.112850923276))-.218472031183),n=277.067027185+e*(218.938950816+e*(69.7360396285+e*(14.2482206905+1*e)))),t/n)},Pe=function(e){var t,n;return 0===e?-.000145727889667:((e<0?-e:e)<=1?(t=e*(e*(e*(199.722374056+-11.4311378756*e)-13.308504545)-.290806748131)-.000145727889667,n=1+e*(139.612587808+e*(2189.01116348+e*(7115.24019009+45574.6081453*e)))):(t=(e=1/e)*(199.722374056+e*(e*(-.000145727889667*e-.290806748131)-13.308504545))-11.4311378756,n=45574.6081453+e*(7115.24019009+e*(2189.01116348+e*(139.612587808+1*e)))),t/n)};var We=r,ze=i,Ae=o,Be=s,Ce=a,Fe=m,Ge=u,He=l,Ie=c,Je=f,Ke=d,Qe=h,Re=p,Se=function(e,t,n,r,i,o,s,a){var m,u,l,c,f,d,h,p,v;v=e,d=1,h=1,c=t*t,u=e;do{if(f=(v=e)*v,0===n){if((m=(1-t)*U(v)+v+o)>U(V))return X("Warning: overflow problems in one or more steps of the computation. The initial approximation to the root is returned."),u;p=S(m)}else p=-s*v;p=a?-p*(Q(v,t,!0,!1)-r):p*(Q(v,t,!0,!0)-i),r>1e-120||h>1?(l=(2*f-4*v*t+4*v+2*c-3*t+1)/f,e=v+p*(1+p*(.5*(v-t+1)/v+p*(l/=6)))):e=v+p,d=R(v/e-1),h+=1,(v=e)<0&&(v=u,h=100)}while(d>2e-14&&h<35);return(d>2e-14||h>99)&&X("Warning: the number of iterations in the Newton method reached the upper limit N=35. The last value obtained for the root is given as output."),v||0},Ue=ie,Ve=function(e){return e>=3?he(ge(e)):e>0?pe(e)/(he(-e+(e-.5)*ve(e))*be):je},Xe=function(e){var t;return we(e)<1?Te(e):(t=ye(e),xe(e/(t-1))/e)},Ye=function(e){var t,n;return e<-5?(12-(n=e*e)-(t=Ne(-e))*t*6)/(12*n*e):e<-2?_e(e):e<2?Oe(e):e<1e3?(n=1/e,qe(e)/(-12*e)):-1/(12*e)},Ze=function(e){var t,n;return e<-8?(t=e*e,(e*(n=Ee(-e)/e)*(6*t*n*n-12+t)-30)/(12*e*t*t)):e<-4?ke(e)/(e*e):e<-2?De(e):e<2?Me(e):e<10?Le(t=1/e)/(e*e):e<100?Pe(t=1/e)/(e*e):-Ee(e)/(12*e*e*e)},$e=K("gammaincinv:compute"),et=.3333333333333333,tt=.16666666666666666,nt=[0,0,0,0,0];var rt=e,it=t,ot=n,st=function(e,t,n){var r,i,o,s,a,m,u,l,c,f,d,h,p,v,j,b,g,w,x,y,T,N,_,O,q,E,k,D,M,L,P,W,z,A,B,C,F,G,H,I;if(t<.5?(s=!0,a=t,G=-1):(s=!1,a=n,G=1),B=0,Fe(e-1)<1e-4&&(C=0,x=s?t<.001?t+.5*(M=t*t)+(E=M*t)*et+.25*(D=E*t)+.2*(w=D*t)+w*t*tt:-Je(1-t):-Je(n),1===e?(B=2,P=x):(o=ze(e),B=1)),n<1e-30&&e<.5&&(C=0,x=-Je(n*Be(e))+(e-1)*Je(-Je(n*Be(e))),B=1,o=ze(e)),e>1&&e<500&&t<1e-80){for(C=0,m=1/e,r=1/(e+1),x=(ze(e+1)+Je(t))*m,p=x=Ge(x),A=0;A<10;A++)x=p*Ge(x*m)*Ie(1-x*r,m);B=1,o=ze(e)}if((u=1/e*(Je(t)+ze(e+1)))<Je(.2*(1+e))&&0===B&&(F=Ge(u),C=0,k=(L=(y=e*e)*e)*e,f=(v=e+1)*(d=v*v),c=d*d,l=(j=e+2)*j,b=e+3,nt[0]=1,nt[1]=1/v,nt[2]=.5*(3*e+5)/(d*j),nt[3]=et*(31+8*y+33*e)/(f*j*b),nt[4]=.041666666666666664*(2888+1179*L+125*k+3971*y+5661*e)/(c*l*b*(e+4)),x=F*We(nt,F),o=ze(e),B=1),e<10&&0===B&&(h=Ce(e)/(Ve(e)*Ke),n<He(.02,h)&&(C=0,q=(O=(W=1-e)*W)*W,g=Ce(-2/e*Je(n/h)),x=e*Ue(g),z=Je(x),x>5?(_=(N=(T=z*z)*z)*z,F=1/x,nt[0]=z-1,nt[1]=.5*(3*W-2*W*z+T-2*z+2),nt[2]=(24*W*z-11*O-24*W-6*T+12*z-12-9*W*T+6*O*z+2*N)*tt,nt[3]=.08333333333333333*(-12*q*z+8.04*W*T-114*O*z+(72+36*T)+(3*_-72*z+162)*(W-168*W*z)-(12*N+25*q)-(22*W*N+36*O*T+120*O)),nt[4]=0,x=x-z+W*F*We(nt,F)):(T=z*z,(H=z-W*(F=1/x)*(z-1))<x&&(x-=H)),o=ze(e),B=1)),Fe(a-.5)<1e-5&&0===B&&(C=0,x=e-et+(.019753086419753086+.007211444248481286*(m=1/e))*m,o=ze(e),B=1),e<1&&0===B&&(C=0,x=Ge(s?1/e*(Je(a)+ze(e+1)):1/e*(Je(1-a)+ze(e+1))),o=ze(e),B=1),0===B){if(C=1,m=1/e,g=G*(F=Ae(2*a))/Ce(.5*e),!(F<Qe))return $e("Warning: Overflow problems in one or more steps of the computation."),NaN;g+=(Xe(g)+(Ye(g)+Ze(g)*m)*m)*m,x=e*Ue(g),I=g,i=1/(-Ce(e/Re)*Ge(-.5*e*I*I)/Ve(e))}return B<2&&(P=Se(x,e,C,t,n,o,i,s)),P};var at=function(e,t,n){return rt(e)||rt(t)||t<it||e>1||e<0?NaN:!0===n?0===e?ot:1===e?0:st(t,1-e,e):0===e?0:1===e?ot:st(t,e,1-e)};export{at as default};
//# sourceMappingURL=index.mjs.map
