// Copyright (c) 2022 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import e from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-assert-is-nan@esm/index.mjs";import t from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float32-smallest-normal@esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-pinf@esm/index.mjs";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-tools-evalpoly@esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-gammaln@esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-erfcinv@esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-gamma@esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-sqrt@esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-abs@esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-exp@esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-min@esm/index.mjs";import p from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-pow@esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-ln@esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-sqrt-two-pi@esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float32-max@esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-two-pi@esm/index.mjs";import j from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-gammainc@esm/index.mjs";import v from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-ln-sqrt-two-pi@esm/index.mjs";function b(e){var t=e.default;if("function"==typeof t){var n=function(){return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})})),n}var g=b(Object.freeze({__proto__:null,default:()=>()=>{}})),x=j,w=m,y=d,O=c,_=u,N=g("gammaincinv:higher_newton");var q=m,P=d,W=c,T=r,k=function(e){return 0===e?0:0+e*(1+e*(1+e*(1.5+e*(2.6666666666666665+e*(5.208333333333333+10.8*e)))))},z=function(e){return 0===e?1:1+e*(1+e*(.3333333333333333+e*(.027777777777777776+e*(e*(.0002314814814814815+5878894767783657e-20*e)-.003703703703703704))))},D=[1,0,0,0,0,0];var E=function(e){var t,n,r,s,i,o,a,m,d;if(d=e*e*.5,0===e?i=0:e<-1?(m=P(-1-d),i=k(m)):e<1?i=z(m=e):(i=(m=11+d)+(o=W(m)),m=1/m,s=(r=(n=(t=o*o)*o)*o)*o,D[1]=.5*(2-o),D[2]=(-9*o+6+2*t)/6,D[3]=.08333333333333333*-(3*n+36*o-22*t-12),D[4]=(60+350*t-300*o-125*n+12*r)/60,D[5]=.008333333333333333*-(-120-274*r+900*o-1700*t+1125*n+20*s),i+=o*m*T(D,m)),m=1,e>-3.5&&e<-.03||e>.03&&e<40){m=1,a=i;do{i=a*(d+W(a))/(a-1),m=q(a/i-1),a=i}while(m>1e-8)}return i},M=[1.9963790515900766,-.0017971032528832887,13129285796384672e-21,-2.340875228178749e-7,7.2291210671127e-9,-3.280997607821e-10,19875070901e-21,-1509214183e-21,1375340084e-22,-145728923e-22,17532367e-22,-2351465e-22,346551e-22,-55471e-22,9548e-22,-1748e-22,3.32e-20,-58e-22];var A=s,B=c,C=v,F=t,G=u,H=function(e,t){var n,r,s,i,o;r=0,s=0,n=t+t,o=e;do{i=s,r=n*(s=r)-i+M[o],o-=1}while(o>=0);return(r-i)/2},I=function(e){return 0===e?.025721014990011306:.025721014990011306+e*(.08247596616699963+e*(e*(.0006099292666946337+e*(.000250505279903*e-.00033543297638406))-.0025328157302663564))},J=function(e){return 0===e?.08333333333333333:.08333333333333333+e*(e*(.0007936507936507937+-.0005952380952380953*e)-.002777777777777778)};var K=d,L=o,Q=c,R=u,S=f,U=function(e){var t;return e<F?G:e<1?A(e+1)-(e+.5)*B(e)+e-C:e<2?A(e)-(e-.5)*B(e)+e-C:e<3?A(e-1)-(e-.5)*B(e)+e-C+B(e-1):e<12?H(17,t=18/(e*e)-1)/(12*e):(t=1/(e*e),e<1e3?I(t)/(.30865217988013566+t)/e:J(t)/e)};var V=m,X=c,Y=E,Z=function(e){var t,n;return 0===e?-.3333333333438:((e<0?-e:e)<=1?(t=e*(e*(e*(-4293658292782e-17*e-.004923635739372)-.05041806657154)-.2070740359969)-.3333333333438,n=1+e*(.7045554412463+e*(.2118190062224+e*(.03048648397436+.001605037988091*e)))):(t=(e=1/e)*(e*(e*(-.3333333333438*e-.2070740359969)-.05041806657154)-.004923635739372)-4293658292782e-17,n=.001605037988091+e*(.03048648397436+e*(.2118190062224+e*(.7045554412463+1*e)))),t/n)};var $=c,ee=function(e){var t,n;return 0===e?-.0172847633523:((e<0?-e:e)<=1?(t=e*(e*(e*(-614830384279e-17*e-.00060683488776)-.00464910887221)-.0159372646475)-.0172847633523,n=1+e*(.764050615669+e*(.297143406325+e*(.0579490176079+.00574558524851*e)))):(t=(e=1/e)*(e*(e*(-.0172847633523*e-.0159372646475)-.00464910887221)-.00060683488776)-614830384279e-17,n=.00574558524851+e*(.0579490176079+e*(.297143406325+e*(.764050615669+1*e)))),t/n)},te=function(e){var t,n;return 0===e?-.0172839517431:((e<0?-e:e)<=1?(t=e*(e*(e*(249634036069e-17*e-.000391032032692)-.00357406772616)-.0146362417966)-.0172839517431,n=1+e*(.690560400696+e*(.249962384741+e*(.0443843438769+.00424073217211*e)))):(t=249634036069e-17+(e=1/e)*(e*(e*(-.0172839517431*e-.0146362417966)-.00357406772616)-.000391032032692),n=.00424073217211+e*(.0443843438769+e*(.249962384741+e*(.690560400696+1*e)))),t/n)},ne=function(e){var t,n;return 0===e?.99994466948:((e<0?-e:e)<=1?(t=.99994466948+e*(104.649839762+e*(857.204033806+e*(731.901559577+45.5174411671*e))),n=1+e*(104.526456943+e*(823.313447808+e*(3119.93802124+3970.03311219*e)))):(t=45.5174411671+(e=1/e)*(731.901559577+e*(857.204033806+e*(104.649839762+.99994466948*e))),n=3970.03311219+e*(3119.93802124+e*(823.313447808+e*(104.526456943+1*e)))),t/n)};var re=c,se=function(e){var t,n;return 0===e?.0495346498136:((e<0?-e:e)<=1?(t=.0495346498136+e*(.0299521337141+e*(.00688296911516+e*(.000512634846317+-201411722031e-16*e))),n=1+e*(.759803615283+e*(.261547111595+e*(.0464854522477+.00403751193496*e)))):(t=(e=1/e)*(.000512634846317+e*(.00688296911516+e*(.0299521337141+.0495346498136*e)))-201411722031e-16,n=.00403751193496+e*(.0464854522477+e*(.261547111595+e*(.759803615283+1*e)))),t/n)},ie=function(e){var t,n;return 0===e?.00452313583942:((e<0?-e:e)<=1?(t=.00452313583942+e*(.00120744920113+e*(e*(-535770949796e-17*e-504476066942e-16)-789724156582e-16)),n=1+e*(.912203410349+e*(.405368773071+e*(.0901638932349+.00948935714996*e)))):(t=(e=1/e)*(e*(e*(.00120744920113+.00452313583942*e)-789724156582e-16)-504476066942e-16)-535770949796e-17,n=.00948935714996+e*(.0901638932349+e*(.405368773071+e*(.912203410349+1*e)))),t/n)},oe=function(e){var t,n;return 0===e?.00439937562904:((e<0?-e:e)<=1?(t=.00439937562904+e*(.000487225670639+e*(e*(529110969589e-17+1.5716677175e-7*e)-.000128470657374)),n=1+e*(.794435257415+e*(.333094721709+e*(.0703527806143+.00806110846078*e)))):(t=1.5716677175e-7+(e=1/e)*(529110969589e-17+e*(e*(.000487225670639+.00439937562904*e)-.000128470657374)),n=.00806110846078+e*(.0703527806143+e*(.333094721709+e*(.794435257415+1*e)))),t/n)},ae=function(e){var t,n;return 0===e?-.0011481191232:((e<0?-e:e)<=1?(t=e*(e*(1.51623048511+e*(.0730002451555*e-.218472031183))-.112850923276)-.0011481191232,n=1+e*(14.2482206905+e*(69.7360396285+e*(218.938950816+277.067027185*e)))):(t=.0730002451555+(e=1/e)*(e*(1.51623048511+e*(-.0011481191232*e-.112850923276))-.218472031183),n=277.067027185+e*(218.938950816+e*(69.7360396285+e*(14.2482206905+1*e)))),t/n)},me=function(e){var t,n;return 0===e?-.000145727889667:((e<0?-e:e)<=1?(t=e*(e*(e*(199.722374056+-11.4311378756*e)-13.308504545)-.290806748131)-.000145727889667,n=1+e*(139.612587808+e*(2189.01116348+e*(7115.24019009+45574.6081453*e)))):(t=(e=1/e)*(199.722374056+e*(e*(-.000145727889667*e-.290806748131)-13.308504545))-11.4311378756,n=45574.6081453+e*(7115.24019009+e*(2189.01116348+e*(139.612587808+1*e)))),t/n)};var de=r,le=s,pe=i,ce=o,fe=a,ue=m,he=d,je=l,ve=p,be=c,ge=f,xe=u,we=h,ye=function(e,t,n,r,s,i,o,a){var m,d,l,p,c,f,u,h,j;j=e,f=1,u=1,p=t*t,d=e;do{if(c=(j=e)*j,0===n){if((m=(1-t)*O(j)+j+i)>O(_))return N("Warning: overflow problems in one or more steps of the computation. The initial approximation to the root is returned."),d;h=y(m)}else h=-o*j;h=a?-h*(x(j,t,!0,!1)-r):h*(x(j,t,!0,!0)-s),r>1e-120||u>1?(l=(2*c-4*j*t+4*j+2*p-3*t+1)/c,e=j+h*(1+h*(.5*(j-t+1)/j+h*(l/=6)))):e=j+h,f=w(j/e-1),u+=1,(j=e)<0&&(j=d,u=100)}while(f>2e-14&&u<35);return(f>2e-14||u>99)&&N("Warning: the number of iterations in the Newton method reached the upper limit N=35. The last value obtained for the root is given as output."),j||0},Oe=E,_e=function(e){return e>=3?K(U(e)):e>0?L(e)/(K(-e+(e-.5)*Q(e))*S):R},Ne=function(e){var t;return V(e)<1?Z(e):(t=Y(e),X(e/(t-1))/e)},qe=function(e){var t,n;return e<-5?(12-(n=e*e)-(t=$(-e))*t*6)/(12*n*e):e<-2?ee(e):e<2?te(e):e<1e3?(n=1/e,ne(e)/(-12*e)):-1/(12*e)},Pe=function(e){var t,n;return e<-8?(t=e*e,(e*(n=re(-e)/e)*(6*t*n*n-12+t)-30)/(12*e*t*t)):e<-4?se(e)/(e*e):e<-2?ie(e):e<2?oe(e):e<10?ae(t=1/e)/(e*e):e<100?me(t=1/e)/(e*e):-re(e)/(12*e*e*e)},We=g("gammaincinv:compute"),Te=.3333333333333333,ke=.16666666666666666,ze=[0,0,0,0,0];var De=e,Ee=t,Me=n,Ae=function(e,t,n){var r,s,i,o,a,m,d,l,p,c,f,u,h,j,v,b,g,x,w,y,O,_,N,q,P,W,T,k,z,D,E,M,A,B,C,F,G,H,I,J;if(t<.5?(o=!0,a=t,H=-1):(o=!1,a=n,H=1),C=0,ue(e-1)<1e-4&&(F=0,w=o?t<.001?t+.5*(z=t*t)+(W=z*t)*Te+.25*(k=W*t)+.2*(x=k*t)+x*t*ke:-be(1-t):-be(n),1===e?(C=2,E=w):(i=le(e),C=1)),n<1e-30&&e<.5&&(F=0,w=-be(n*ce(e))+(e-1)*be(-be(n*ce(e))),C=1,i=le(e)),e>1&&e<500&&t<1e-80){for(F=0,m=1/e,r=1/(e+1),w=(le(e+1)+be(t))*m,h=w=he(w),B=0;B<10;B++)w=h*he(w*m)*ve(1-w*r,m);C=1,i=le(e)}if((d=1/e*(be(t)+le(e+1)))<be(.2*(1+e))&&0===C&&(G=he(d),F=0,T=(D=(y=e*e)*e)*e,c=(j=e+1)*(f=j*j),p=f*f,l=(v=e+2)*v,b=e+3,ze[0]=1,ze[1]=1/j,ze[2]=.5*(3*e+5)/(f*v),ze[3]=Te*(31+8*y+33*e)/(c*v*b),ze[4]=.041666666666666664*(2888+1179*D+125*T+3971*y+5661*e)/(p*l*b*(e+4)),w=G*de(ze,G),i=le(e),C=1),e<10&&0===C&&(u=fe(e)/(_e(e)*ge),n<je(.02,u)&&(F=0,P=(q=(M=1-e)*M)*M,g=fe(-2/e*be(n/u)),w=e*Oe(g),A=be(w),w>5?(N=(_=(O=A*A)*A)*A,G=1/w,ze[0]=A-1,ze[1]=.5*(3*M-2*M*A+O-2*A+2),ze[2]=(24*M*A-11*q-24*M-6*O+12*A-12-9*M*O+6*q*A+2*_)*ke,ze[3]=.08333333333333333*(-12*P*A+8.04*M*O-114*q*A+(72+36*O)+(3*N-72*A+162)*(M-168*M*A)-(12*_+25*P)-(22*M*_+36*q*O+120*q)),ze[4]=0,w=w-A+M*G*de(ze,G)):(O=A*A,(I=A-M*(G=1/w)*(A-1))<w&&(w-=I)),i=le(e),C=1)),ue(a-.5)<1e-5&&0===C&&(F=0,w=e-Te+(.019753086419753086+.007211444248481286*(m=1/e))*m,i=le(e),C=1),e<1&&0===C&&(F=0,w=he(o?1/e*(be(a)+le(e+1)):1/e*(be(1-a)+le(e+1))),i=le(e),C=1),0===C){if(F=1,m=1/e,g=H*(G=pe(2*a))/fe(.5*e),!(G<xe))return We("Warning: Overflow problems in one or more steps of the computation."),NaN;g+=(Ne(g)+(qe(g)+Pe(g)*m)*m)*m,w=e*Oe(g),J=g,s=1/(-fe(e/we)*he(-.5*e*J*J)/_e(e))}return C<2&&(E=ye(w,e,F,t,n,i,s,o)),E};var Be=function(e,t,n){return De(e)||De(t)||t<Ee||e>1||e<0?NaN:!0===n?0===e?Me:1===e?0:Ae(t,1-e,e):0===e?0:1===e?Me:Ae(t,e,1-e)};export{Be as default};
//# sourceMappingURL=index.mjs.map
